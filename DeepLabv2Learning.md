# 学习论文[DeepLabv2:Semantic Image Segmentation with Deep Convolutional Nets, Atrous Convolution, and Fully Connected CRFs](https://arxiv.org/pdf/1606.00915.pdf)

## 摘要&介绍

### 1 三个贡献

#### (1) 空洞卷积

- 控制特征图的分辨率
- 不增加参数的前提下扩大过滤器的接受野，包含更大的上下文

#### (2) 空洞空间金字塔池化(ASPP:Atrous Spatial Pyramid Pooling)

- 多尺度分割
- ASPP用过滤器以多种采样率和有效的视野探测卷积特征层，捕获不同尺度的目标和图像上下文

#### (3) 结合DCNN和CRF来改进对象边界的定位

### 2 将DCNN应用到语义分割的三个困难

#### (1) 降低特征图的分辨率（DeepLabv1中提到）

- 最大池化下采样导致输出的特征图分辨率降低

- 解决：在最后的几个最大池化层中去掉下采样，并**在它之后的卷积层中对滤波器进行上采样（即空洞卷积）**，得到更密集的特征图，之后只要采用简单的双线性插值恢复到原图像大小
  - 在DeepLabv1中，是保持过滤器不变，**对特征图进行稀疏采样**

#### (2) 多尺度目标的存在

- 标准方法
  - 将图像不同缩放版本后交给DCNN，之后整合特征图/分数图
  - 缺点：计算量大
- 采用**空间金字塔池化(SPP)**
  - 在卷积之前以不同的采样率重新采样特征
  - 实现：
    - 并非真的对特征进行重采样，而是使用不同的并行的**具有不同的采样率的空洞卷积层**代替，称作**ASPP(空洞空间金字塔池化)**

#### (3) DCNN的不变性降低定位精度（DeepLabv1提到）

- 一种方法
  - 使用跳跃连接（像FCN）
- 采用更高效的方法
  - 使用CRF来增强捕获细节的能力
    - CRF已经广泛应用到语义分割：将多路分类器输出的类别分数图和低级信息结合
  - 使用**全连接的二元CRF**
    - 优点：很好的捕获边缘细节，适合长范围的依赖

### 3 DeepLab模型（DeepLabv1提到）

![](.\Figures\DeepLabv2\deeplab_model.JPG)

- 将全连接层转换为卷积层
- 通过空洞卷积层增大接受野（因为将最后两个下采样去掉了，图像缩小到1/8，非1/32，图像较大，见DeepLabv1）
- 通过简单的双线性插值（8x，扩大到原图像大小）
- 输入全连接CRF提高定位精度

### 4 DeepLabv2 vs DeepLabv1

- 通过扩展Caffe框架，实现提出的ASPP，更好地解决不同尺度图像分割问题



## 方法

### 1 空洞卷积——用于提取密集特征&扩大接受野

#### (1) 一维

![](.\Figures\DeepLabv2\atrous_convolution.JPG)

- 表达式
  $$
  y[i]=\sum_{k=1}^Kx[i+r\cdot k]w[k]\\
  其中，r为步长
  $$
  

#### (2) 二维

- 对过滤器进行**上采样**

  - 在过滤器中插入0值（如上图b）：k x k -> (k+(r-1)(k-1)) x (k+(r-1)(k-1))
  - 虽然增大了过滤器的大小，但是只需要考虑非零的值，所以过滤器的参数没有增加

- 直接在高分辨率的图像上进行密集特征提取（如下图下行）

  - DeepLabv1中提到去掉最后两个最大池化层中的下采样，则输出的图像是原图像的1/8，分辨率高
  - 在之后直接对高分辨率图像（1/8）进行空洞卷积比下采样后卷积再上采样（如下图上行，FCN）效果好很多

  ![](.\Figures\DeepLabv2\atrous_convolution_2D.JPG)

### 2 ASPP——用于多尺度图像

### 3 全连接CRF——用于恢复精确的边界